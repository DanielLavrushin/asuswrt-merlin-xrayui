import{_ as t,a as i,b as o,c as r}from"./20251025013437-C6_y1YdW.js";import{_ as l,c,a,b as d,d as p,w as u,e as s,r as h,o as m}from"./app-BsG86pRf.js";const g={};function b(y,e){const n=h("RouteLink");return m(),c("div",null,[e[2]||(e[2]=a('<h1 id="routing-rules" tabindex="-1"><a class="header-anchor" href="#routing-rules"><span>Routing Rules</span></a></h1><p>Routing rules determine which outbound handles specific traffic: proxy, direct (<code>freedom</code>), or block (<code>blackhole</code>). Rules are evaluated <strong>top to bottom</strong> — first match wins.</p><h2 id="how-traffic-reaches-xray" tabindex="-1"><a class="header-anchor" href="#how-traffic-reaches-xray"><span>How Traffic Reaches Xray</span></a></h2><p>Not all traffic automatically goes through Xray. There are three processing layers, and each one only works with what passed through the previous one.</p><h3 id="layer-1-interception-b-r-policies" tabindex="-1"><a class="header-anchor" href="#layer-1-interception-b-r-policies"><span>Layer 1: Interception (B/R Policies)</span></a></h3>',5)),d("p",null,[p(n,{to:"/en/br-policy.html"},{default:u(()=>[...e[0]||(e[0]=[s("Bypass/Redirect policies",-1)])]),_:1}),e[1]||(e[1]=s(" determine which devices and ports are intercepted. Traffic that isn't intercepted goes direct — Xray never sees it.",-1))]),e[3]||(e[3]=a('<h3 id="layer-2-dns-bypass-before-xray" tabindex="-1"><a class="header-anchor" href="#layer-2-dns-bypass-before-xray"><span>Layer 2: DNS Bypass (before Xray)</span></a></h3><p>Intercepted traffic can be further filtered <strong>before</strong> reaching Xray. This reduces router CPU load but limits routing flexibility.</p><p>By default, all intercepted traffic is redirected to Xray&#39;s dokodemo-door inbound port. On weak routers, this creates high CPU load under heavy traffic. DNS bypass solves this by filtering traffic at the iptables/ipset level before Xray.</p><h4 id="modes" tabindex="-1"><a class="header-anchor" href="#modes"><span>Modes</span></a></h4><ul><li><p><strong>OFF</strong> — all intercepted traffic goes to Xray. Routing rules work fully.</p></li><li><p><strong>BYPASS</strong> — extracts domains from rules with <code>freedom</code> outbound type. Traffic to those domains <strong>skips Xray</strong> and goes direct. For example, a rule <code>domain:ru</code> → <code>freedom</code> means all <code>.ru</code> traffic bypasses Xray. Everything else enters Xray.</p></li><li><p><strong>REDIRECT</strong> — inverse of BYPASS. Extracts domains from rules with outbound type <strong>other than</strong> <code>freedom</code>, and only that traffic enters Xray. For example, a rule <code>geosite:youtube</code> → <code>proxy</code> means only YouTube traffic enters Xray; everything else goes direct.</p></li></ul><div class="hint-container important"><p class="hint-container-title">Important</p><p>DNS bypass operates <strong>before</strong> Xray routing rules. Traffic filtered at this layer never reaches Xray, and routing rules won&#39;t apply to it.</p></div><div class="hint-container note"><p class="hint-container-title">Note</p><p>Geodata categories occasionally contain entries with the <code>regexp:</code> prefix. These are ignored by DNS bypass — ipset doesn&#39;t support regular expressions.</p></div><h3 id="layer-3-xray-routing-rules" tabindex="-1"><a class="header-anchor" href="#layer-3-xray-routing-rules"><span>Layer 3: Xray Routing Rules</span></a></h3><p>Traffic that passes through the previous layers is processed by Xray&#39;s routing rules — the rest of this document covers them.</p><h2 id="domain-syntax" tabindex="-1"><a class="header-anchor" href="#domain-syntax"><span>Domain Syntax</span></a></h2><h3 id="prefixes" tabindex="-1"><a class="header-anchor" href="#prefixes"><span>Prefixes</span></a></h3><table><thead><tr><th>Prefix</th><th>Behavior</th><th>Example</th></tr></thead><tbody><tr><td><code>domain:</code></td><td>Domain + all subdomains</td><td><code>domain:google.com</code> → <code>google.com</code>, <code>maps.google.com</code></td></tr><tr><td><code>full:</code></td><td>Exact match only</td><td><code>full:google.com</code> → only <code>google.com</code></td></tr><tr><td><code>keyword:</code></td><td>Contains substring</td><td><code>keyword:google</code> → <code>google.com</code>, <code>mygooglesite.net</code></td></tr><tr><td><code>regexp:</code></td><td>Regular expression</td><td><code>regexp:.*\\.edu$</code> → <code>harvard.edu</code>, <code>mit.edu</code></td></tr><tr><td><code>geosite:</code></td><td>Geosite database category</td><td><code>geosite:netflix</code> → all Netflix domains</td></tr><tr><td><code>ext:xrayui:</code></td><td>Custom domain list</td><td><code>ext:xrayui:mylist</code> → domains from your custom list</td></tr></tbody></table><h3 id="domain-matching-examples" tabindex="-1"><a class="header-anchor" href="#domain-matching-examples"><span><code>domain:</code> matching examples</span></a></h3><ul><li><code>domain:com</code> — all <code>.com</code> domains and their subdomains</li><li><code>domain:dmn.com</code> — <code>dmn.com</code>, <code>www.dmn.com</code>, <code>sub.domain.dmn.com</code></li><li><code>domain:www.dmn.com</code> — only <code>www.dmn.com</code> and its subdomains, not <code>dmn.com</code></li></ul><h2 id="geosite-databases" tabindex="-1"><a class="header-anchor" href="#geosite-databases"><span>Geosite Databases</span></a></h2><p>Geosite files are community-maintained lists of domains grouped by category. Instead of manually listing dozens of domains for a service, you can use a single category tag.</p><p>Example — <code>geosite:youtube</code> includes <code>youtube.com</code>, <code>youtu.be</code>, <code>youtube-nocookie.com</code>, CDNs, regional domains, etc.</p><h3 id="common-categories" tabindex="-1"><a class="header-anchor" href="#common-categories"><span>Common Categories</span></a></h3><table><thead><tr><th>Category</th><th>Description</th></tr></thead><tbody><tr><td><code>geosite:google</code></td><td>All Google services</td></tr><tr><td><code>geosite:youtube</code></td><td>YouTube and related domains</td></tr><tr><td><code>geosite:netflix</code></td><td>Netflix</td></tr><tr><td><code>geosite:facebook</code></td><td>Facebook and Instagram</td></tr><tr><td><code>geosite:twitter</code></td><td>Twitter/X</td></tr><tr><td><code>geosite:telegram</code></td><td>Telegram</td></tr><tr><td><code>geosite:spotify</code></td><td>Spotify</td></tr><tr><td><code>geosite:category-ads-all</code></td><td>Ad networks</td></tr><tr><td><code>geosite:category-media-ru</code></td><td>Blocked media in Russia</td></tr><tr><td><code>geosite:cn</code></td><td>Chinese domains</td></tr><tr><td><code>geosite:geolocation-!cn</code></td><td>Non-Chinese domains</td></tr></tbody></table><p>Full list of categories: <a href="https://github.com/v2fly/domain-list-community/tree/master/data" target="_blank" rel="noopener noreferrer">v2fly/domain-list-community</a></p><h3 id="updating-databases" tabindex="-1"><a class="header-anchor" href="#updating-databases"><span>Updating Databases</span></a></h3><p><strong>Manual:</strong> Routing → <strong>Update community files</strong> → Apply</p><p><strong>Automatic:</strong> General Options → Geodata → <strong>Auto-update geodata files</strong> (updates at 03:00)</p><h3 id="custom-lists" tabindex="-1"><a class="header-anchor" href="#custom-lists"><span>Custom Lists</span></a></h3><p>You can create your own domain categories and use them in rules as <code>ext:xrayui:name</code>. Details: <a href="custom-geodata">Geodata Files Manager</a>.</p><h2 id="geoip" tabindex="-1"><a class="header-anchor" href="#geoip"><span>GeoIP</span></a></h2><table><thead><tr><th>Category</th><th>Description</th></tr></thead><tbody><tr><td><code>geoip:cn</code></td><td>Chinese IP addresses</td></tr><tr><td><code>geoip:us</code></td><td>US IP addresses</td></tr><tr><td><code>geoip:private</code></td><td>Private/LAN addresses</td></tr><tr><td><code>geoip:cloudflare</code></td><td>Cloudflare IPs</td></tr></tbody></table><h2 id="managing-rules" tabindex="-1"><a class="header-anchor" href="#managing-rules"><span>Managing Rules</span></a></h2><h3 id="interface" tabindex="-1"><a class="header-anchor" href="#interface"><span>Interface</span></a></h3><ol><li>Go to the <strong>Routing</strong> section <img src="'+t+'" alt=""></li><li>Click <strong>Manage</strong> next to <strong>Rules</strong><img src="'+i+'" alt=""></li></ol><h3 id="adding-a-rule" tabindex="-1"><a class="header-anchor" href="#adding-a-rule"><span>Adding a Rule</span></a></h3><p>Click <strong>Add new rule</strong>. Fill in the fields:</p><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td><strong>Friendly Name</strong></td><td>Descriptive name for the rule</td></tr><tr><td><strong>Outbound connection</strong></td><td>Where to send traffic: proxy, direct, block</td></tr><tr><td><strong>Enabled</strong></td><td>Toggle rule on/off</td></tr></tbody></table><h3 id="matching-criteria" tabindex="-1"><a class="header-anchor" href="#matching-criteria"><span>Matching Criteria</span></a></h3><p><img src="'+o+`" alt=""></p><p>A rule can have one or more criteria. When multiple are specified, <strong>AND</strong> logic applies — all conditions must match.</p><div class="hint-container tip"><p class="hint-container-title">Tips</p><p>If nothing is selected in a field, everything matches. You don&#39;t need to select all options to cover all traffic — just leave the field blank.</p></div><h4 id="domains" tabindex="-1"><a class="header-anchor" href="#domains"><span>Domains</span></a></h4><p>One per line. Supported formats: <code>domain:</code>, <code>full:</code>, <code>keyword:</code>, <code>regexp:</code>, <code>geosite:</code>, <code>ext:xrayui:</code>.</p><div class="hint-container tip"><p class="hint-container-title">Tips</p><p>The <strong>geosite:</strong> and <strong>ext:xrayui:</strong> buttons above the input field insert the prefix. Autocomplete helps find available tags.</p></div><h4 id="ip-addresses" tabindex="-1"><a class="header-anchor" href="#ip-addresses"><span>IP Addresses</span></a></h4><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">192.168.1.1</span>
<span class="line">192.168.1.0/24</span>
<span class="line">geoip:cn</span>
<span class="line">geoip:private</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="source-ips" tabindex="-1"><a class="header-anchor" href="#source-ips"><span>Source IPs</span></a></h4><p>Filter by source device IP:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">192.168.1.100</span>
<span class="line">192.168.1.0/24</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ports" tabindex="-1"><a class="header-anchor" href="#ports"><span>Ports</span></a></h4><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">443</span>
<span class="line">8080:8090</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container note"><p class="hint-container-title">Note</p><p>Use colon (<code>:</code>) for ranges, not a hyphen.</p></div><h4 id="networks" tabindex="-1"><a class="header-anchor" href="#networks"><span>Networks</span></a></h4><ul><li><strong>tcp</strong> — TCP only</li><li><strong>udp</strong> — UDP only (including QUIC/HTTP3)</li><li>Empty — both</li></ul><h4 id="protocols" tabindex="-1"><a class="header-anchor" href="#protocols"><span>Protocols</span></a></h4><ul><li><strong>http</strong>, <strong>tls</strong>, <strong>bittorrent</strong>, <strong>quic</strong></li></ul><p>Detected by packet inspection, not port numbers.</p><h3 id="rule-order" tabindex="-1"><a class="header-anchor" href="#rule-order"><span>Rule Order</span></a></h3><p>Use the up/down buttons to reorder rules. More specific rules go higher, catch-all rules at the bottom.</p><h3 id="saving" tabindex="-1"><a class="header-anchor" href="#saving"><span>Saving</span></a></h3><ol><li><strong>Save</strong> in the rule editor</li><li><strong>Apply</strong> on the main page</li></ol><h3 id="system-rules" tabindex="-1"><a class="header-anchor" href="#system-rules"><span>System Rules</span></a></h3><p>Some rules are auto-generated (DNS, B/R policies). They can&#39;t be edited directly but can be disabled.</p><h3 id="disabling-rules" tabindex="-1"><a class="header-anchor" href="#disabling-rules"><span>Disabling Rules</span></a></h3><p>Uncheck a rule&#39;s checkbox — it moves to the &quot;disabled&quot; section and retains its configuration.</p><h2 id="example-rules" tabindex="-1"><a class="header-anchor" href="#example-rules"><span>Example Rules</span></a></h2><h3 id="netflix-via-proxy" tabindex="-1"><a class="header-anchor" href="#netflix-via-proxy"><span>Netflix via proxy</span></a></h3><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">Friendly Name</span><span class="token punctuation">:</span> Netflix proxy</span>
<span class="line"><span class="token key atrule">Outbound</span><span class="token punctuation">:</span> proxy</span>
<span class="line"><span class="token key atrule">Domains</span><span class="token punctuation">:</span> geosite<span class="token punctuation">:</span>netflix</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="block-ads" tabindex="-1"><a class="header-anchor" href="#block-ads"><span>Block ads</span></a></h3><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">Friendly Name</span><span class="token punctuation">:</span> Block ads</span>
<span class="line"><span class="token key atrule">Outbound</span><span class="token punctuation">:</span> block</span>
<span class="line"><span class="token key atrule">Domains</span><span class="token punctuation">:</span> geosite<span class="token punctuation">:</span>category<span class="token punctuation">-</span>ads<span class="token punctuation">-</span>all</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="local-network-direct" tabindex="-1"><a class="header-anchor" href="#local-network-direct"><span>Local network direct</span></a></h3><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">Friendly Name</span><span class="token punctuation">:</span> LAN direct</span>
<span class="line"><span class="token key atrule">Outbound</span><span class="token punctuation">:</span> direct</span>
<span class="line"><span class="token key atrule">IPs</span><span class="token punctuation">:</span></span>
<span class="line">  geoip<span class="token punctuation">:</span>private</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="torrents-direct" tabindex="-1"><a class="header-anchor" href="#torrents-direct"><span>Torrents direct</span></a></h3><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">Friendly Name</span><span class="token punctuation">:</span> Torrents direct</span>
<span class="line"><span class="token key atrule">Outbound</span><span class="token punctuation">:</span> direct</span>
<span class="line"><span class="token key atrule">Protocols</span><span class="token punctuation">:</span> bittorrent</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="specific-device-https-via-proxy" tabindex="-1"><a class="header-anchor" href="#specific-device-https-via-proxy"><span>Specific device HTTPS via proxy</span></a></h3><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">Friendly Name</span><span class="token punctuation">:</span> Laptop HTTPS proxy</span>
<span class="line"><span class="token key atrule">Outbound</span><span class="token punctuation">:</span> proxy</span>
<span class="line"><span class="token key atrule">Source IPs</span><span class="token punctuation">:</span> 192.168.1.100</span>
<span class="line"><span class="token key atrule">Ports</span><span class="token punctuation">:</span> <span class="token number">443</span></span>
<span class="line"><span class="token key atrule">Networks</span><span class="token punctuation">:</span> tcp</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="common-routing-schemes" tabindex="-1"><a class="header-anchor" href="#common-routing-schemes"><span>Common Routing Schemes</span></a></h2><h3 id="proxy-everything-except-local" tabindex="-1"><a class="header-anchor" href="#proxy-everything-except-local"><span>Proxy everything except local</span></a></h3><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">Rule 1 — direct</span><span class="token punctuation">:</span> <span class="token key atrule">IPs</span><span class="token punctuation">:</span> geoip<span class="token punctuation">:</span>private</span>
<span class="line"><span class="token key atrule">Rule 2 — proxy</span><span class="token punctuation">:</span>  (empty criteria = catch<span class="token punctuation">-</span>all)</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="only-specific-services-via-proxy" tabindex="-1"><a class="header-anchor" href="#only-specific-services-via-proxy"><span>Only specific services via proxy</span></a></h3><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">Rule 1 — proxy</span><span class="token punctuation">:</span>  <span class="token key atrule">Domains</span><span class="token punctuation">:</span> geosite<span class="token punctuation">:</span>netflix<span class="token punctuation">,</span> geosite<span class="token punctuation">:</span>youtube</span>
<span class="line"><span class="token key atrule">Rule 2 — direct</span><span class="token punctuation">:</span> (catch<span class="token punctuation">-</span>all)</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="bypass-regional-restrictions-russia" tabindex="-1"><a class="header-anchor" href="#bypass-regional-restrictions-russia"><span>Bypass regional restrictions (Russia)</span></a></h3><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">Rule 1 — proxy</span><span class="token punctuation">:</span>  <span class="token key atrule">Domains</span><span class="token punctuation">:</span> geosite<span class="token punctuation">:</span>category<span class="token punctuation">-</span>media<span class="token punctuation">-</span>ru</span>
<span class="line"><span class="token key atrule">Rule 2 — direct</span><span class="token punctuation">:</span> <span class="token key atrule">Domains</span><span class="token punctuation">:</span> geosite<span class="token punctuation">:</span>ru</span>
<span class="line"><span class="token key atrule">Rule 3 — proxy</span><span class="token punctuation">:</span>  <span class="token key atrule">Domains</span><span class="token punctuation">:</span> geosite<span class="token punctuation">:</span>geolocation<span class="token punctuation">-</span><span class="token tag">!ru</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="performance-optimization-with-dns-bypass" tabindex="-1"><a class="header-anchor" href="#performance-optimization-with-dns-bypass"><span>Performance optimization with DNS bypass</span></a></h3><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">DNS Bypass</span><span class="token punctuation">:</span> REDIRECT mode</span>
<span class="line"><span class="token key atrule">B/R Policy</span><span class="token punctuation">:</span> Redirect ports 80<span class="token punctuation">,</span><span class="token number">443</span></span>
<span class="line"></span>
<span class="line"><span class="token key atrule">Rules</span><span class="token punctuation">:</span></span>
<span class="line">1. geosite<span class="token punctuation">:</span>youtube → proxy</span>
<span class="line">2. geosite<span class="token punctuation">:</span>netflix → proxy</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Only YouTube and Netflix go through Xray. Everything else bypasses at the iptables level.</p><h3 id="maximum-control" tabindex="-1"><a class="header-anchor" href="#maximum-control"><span>Maximum control</span></a></h3><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">DNS Bypass</span><span class="token punctuation">:</span> OFF</span>
<span class="line"><span class="token key atrule">B/R Policy</span><span class="token punctuation">:</span> Redirect all</span>
<span class="line"></span>
<span class="line"><span class="token key atrule">Rules</span><span class="token punctuation">:</span></span>
<span class="line">1. domain<span class="token punctuation">:</span>company.com → work<span class="token punctuation">-</span>proxy</span>
<span class="line">2. geosite<span class="token punctuation">:</span>netflix → us<span class="token punctuation">-</span>proxy</span>
<span class="line">3. geosite<span class="token punctuation">:</span>twitter → europe<span class="token punctuation">-</span>proxy</span>
<span class="line">4. ports<span class="token punctuation">:</span>27000<span class="token punctuation">-</span>27100 → direct</span>
<span class="line">5. (catch<span class="token punctuation">-</span>all) → proxy</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>All traffic goes through Xray for evaluation.</p><h2 id="advanced" tabindex="-1"><a class="header-anchor" href="#advanced"><span>Advanced</span></a></h2><h3 id="domain-matcher" tabindex="-1"><a class="header-anchor" href="#domain-matcher"><span>Domain Matcher</span></a></h3><p><img src="`+r+`" alt=""></p><ul><li><strong>hybrid</strong> (default) — balanced speed and accuracy</li><li><strong>linear</strong> — sequential matching, more accurate but slower</li></ul><h3 id="balancers" tabindex="-1"><a class="header-anchor" href="#balancers"><span>Balancers</span></a></h3><p>Rules can route traffic to balancers instead of a single outbound:</p><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">Outbound</span><span class="token punctuation">:</span> balancer<span class="token punctuation">-</span>us</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="troubleshooting" tabindex="-1"><a class="header-anchor" href="#troubleshooting"><span>Troubleshooting</span></a></h2><h3 id="rules-not-working" tabindex="-1"><a class="header-anchor" href="#rules-not-working"><span>Rules not working</span></a></h3><ol><li><strong>DNS bypass</strong> — traffic may be filtered before Xray. Temporarily set to OFF to test.</li><li><strong>B/R policies</strong> — traffic may not be intercepted. Check MAC addresses and ports.</li><li><strong>Rule order</strong> — specific rules must be above general ones.</li><li><strong>Outbound</strong> — verify the specified outbound exists.</li><li><strong>Syntax</strong> — <code>domain:</code> not <code>domain.</code>, <code>geosite:</code> not <code>geosite.</code>.</li></ol><h3 id="traffic-not-being-proxied" tabindex="-1"><a class="header-anchor" href="#traffic-not-being-proxied"><span>Traffic not being proxied</span></a></h3><ul><li>DNS bypass in REDIRECT mode with the domain matching a <code>freedom</code> rule</li><li>B/R policy doesn&#39;t include the needed ports</li><li>QUIC/HTTP3 (UDP 443) not intercepted — add UDP 443 to the policy</li></ul><h3 id="unexpected-direct-connections" tabindex="-1"><a class="header-anchor" href="#unexpected-direct-connections"><span>Unexpected direct connections</span></a></h3><ul><li>Ipset rules from DNS bypass creating kernel-level bypasses</li><li>IPv6 traffic not being handled</li><li>Cached DNS responses from a previous configuration</li></ul><h3 id="debugging" tabindex="-1"><a class="header-anchor" href="#debugging"><span>Debugging</span></a></h3><p>Enable logs: General Options → Logs → <strong>Access logs</strong>, level <code>info</code> or <code>debug</code>.</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">tail</span> <span class="token parameter variable">-f</span> /tmp/log/xray_access.log</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="hint-container note"><p class="hint-container-title">Note</p><p>After any changes, click <strong>Apply</strong> on the main page to activate the new configuration.</p></div>`,103))])}const k=l(g,[["render",b]]),x=JSON.parse('{"path":"/en/routing.html","title":"Routing Rules","lang":"en-US","frontmatter":{},"git":{"updatedTime":1771801533000,"contributors":[{"name":"Daniel Lavrushin","username":"","email":"lavrushin@gmail.com","commits":2}],"changelog":[{"hash":"7dec3619981886deac218d204cbdcf3897b5efcf","time":1771801533000,"email":"lavrushin@gmail.com","author":"Daniel Lavrushin","message":"Fix typos and improve clarity in Russian documentation for general options and routing rules"},{"hash":"198f5dcc71b58fcec3c0f1f2ab3ac9a636f56216","time":1761350718000,"email":"lavrushin@gmail.com","author":"Daniel Lavrushin","message":"Add Russian documentation for routing rules and v2dat usage in XRAYUI"}]},"filePathRelative":"en/routing.md"}');export{k as comp,x as data};
