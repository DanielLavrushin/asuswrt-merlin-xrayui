import{_ as r}from"./20250816215559-LfT-XQO0.js";import{_ as o,c as s,a as n,o as e}from"./app-eTybrgsj.js";const d="/asuswrt-merlin-xrayui/assets/20250816222353-Dx_Ji3QL.png",a="/asuswrt-merlin-xrayui/assets/20250816222456-CrlTQRtt.png",i="/asuswrt-merlin-xrayui/assets/20250816222523-C8PMbeNU.png",c={};function l(p,t){return e(),s("div",null,t[0]||(t[0]=[n('<h1 id="прозрачное-проксирование-tproxy" tabindex="-1"><a class="header-anchor" href="#прозрачное-проксирование-tproxy"><span>Прозрачное проксирование (TPROXY)</span></a></h1><p>XRAYUI поддерживает два режима маршрутизации:</p><ul><li>режим <code>REDIRECT</code></li><li>режим <code>TPROXY</code></li></ul><h2 id="что-такое-redirect" tabindex="-1"><a class="header-anchor" href="#что-такое-redirect"><span>Что такое REDIRECT</span></a></h2><p><code>REDIRECT</code> использует NAT (цели iptables <code>REDIRECT</code>/DNAT в цепочке <code>PREROUTING</code>) для перенаправления трафика на локальный порт прослушивания (ваш входящий <strong>dokodemo</strong>).</p><p>Ключевые особенности:</p><ul><li>Простой развёртывание; не требует политик <code>routing</code> и <code>fwmarks</code>.</li><li>В первую очередь подходит для <code>TCP</code>. <code>UDP</code> и <code>QUIC/HTTP3</code> в этом режиме работают ненадёжно.</li><li>Исходный адрес/порт назначения не сохраняется, что ограничивает продвинутую маршрутизацию и поведение некоторых протоколов.</li></ul><h2 id="что-такое-tproxy" tabindex="-1"><a class="header-anchor" href="#что-такое-tproxy"><span>Что такое TPROXY</span></a></h2><p><code>TPROXY</code> (Transparent Proxy) использует цель iptables <code>TPROXY</code> (таблица mangle) вместе с <code>policy routing</code> и <code>fwmarks</code>. Xray привязывается с <code>IP_TRANSPARENT</code>, поэтому получает пакеты с сохранением исходных адресов назначения (и источника).<br> Ключевые преимущества:</p><ul><li>Надёжно обрабатывает и <code>TCP</code>, и <code>UDP</code>, включая <code>QUIC/HTTP3</code>.</li><li>Сохраняет исходный адрес назначения, что обеспечивает точные решения маршрутизации и меньше пограничных случаев.</li><li>Рекомендуется для большинства установок.</li></ul><div class="hint-container info"><p class="hint-container-title">Инфо</p><p>При включении <code>TPROXY</code> XRAYUI автоматически настраивает необходимые правила файрвола и policy routing.</p></div><h2 id="tproxy-против-redirect-на-asuswrt-merlin" tabindex="-1"><a class="header-anchor" href="#tproxy-против-redirect-на-asuswrt-merlin"><span>TPROXY против REDIRECT на Asuswrt-Merlin</span></a></h2><p>XRAYUI на Asuswrt-Merlin берёт на себя сложную часть. Выберите режим под ваши сценарии и нажмите <strong>Apply</strong>.</p><table><thead><tr><th>Что вы делаете</th><th>Выберите</th><th>Почему это помогает</th></tr></thead><tbody><tr><td>Онлайн-игры и голосовой чат</td><td><strong>TPROXY</strong></td><td>Стабильнее для игрового трафика и чатов; меньше случайных обрывов.</td></tr><tr><td>Видеостриминг — YouTube, 4K, IPTV</td><td><strong>TPROXY</strong></td><td>Современные стримы могут использовать QUIC/HTTP3; с TPROXY меньше буфера.</td></tr><tr><td>Видеозвонки — Zoom/Teams/Meet</td><td><strong>TPROXY</strong></td><td>Более надёжные аудио/видео-каналы.</td></tr><tr><td>Загрузки и торренты</td><td><strong>TPROXY</strong></td><td>Лучше, когда приложения используют UDP-трекеры и DHT.</td></tr><tr><td>Повседневный веб, почта, сайты</td><td><strong>REDIRECT</strong></td><td>Просто и стабильно для классического серфинга. Если сайт капризничает — обход.</td></tr><tr><td>Смарт-ТВ, консоли, приставки</td><td><strong>TPROXY</strong></td><td>Лучший выбор для смешанных приложений и стриминга на технике в гостиной.</td></tr><tr><td>Умный дом, принтеры, локальный NAS</td><td><strong>REDIRECT</strong></td><td>Проще — лучше; такой трафик в основном локальный.</td></tr><tr><td>Старый/маломощный роутер</td><td><strong>REDIRECT</strong></td><td>Легче и быстрее. <strong>TPROXY требует больших ресурсов</strong>. При необходимости позже переключитесь на TPROXY.</td></tr></tbody></table><h3 id="ну-короче-говоря" tabindex="-1"><a class="header-anchor" href="#ну-короче-говоря"><span>Ну, короче говоря</span></a></h3><ul><li>Если вы играете, стримите или часто звоните — начинайте с <strong>TPROXY</strong>. Большая нагрузка на роутер.</li><li>Если в основном просто просматриваете сайты и простой онлайн — подойдёт <strong>REDIRECT</strong>. Меньшая нагрузка на роутер.</li></ul><div class="hint-container tip"><p class="hint-container-title">Совет</p><p>Разные устройства дома? Используйте <strong>TPROXY</strong> по умолчанию, а затем исключайте устройство или порт через <strong>Bypass/Redirect Policy</strong>, если что-то работает некорректно.</p></div><div class="hint-container note"><p class="hint-container-title">Заметка</p><p>После смены режима у входящего <strong>dokodemo</strong> вернитесь на главную страницу и нажмите <strong>Apply</strong>, чтобы XRAYUI обновил правила роутера.</p></div><div class="hint-container warning"><p class="hint-container-title">Примечание</p><p>Большинство современных маршрутизаторов ASUS (AC/AX/BE) поддерживают <code>TPROXY</code>. Если ваша прошивка не поддерживает <code>TPROXY</code> на этой модели, выберите <strong>REDIRECT</strong>. Позже можно переключиться после обновления.</p></div><h2 id="как-переключиться-на-tproxy" tabindex="-1"><a class="header-anchor" href="#как-переключиться-на-tproxy"><span>Как переключиться на TPROXY</span></a></h2><p>В целом XRAY/XRAYUI лучше работает в режиме TPROXY. Рекомендуется перевести основной inbound на TPROXY.</p><p><img src="'+r+'" alt="transport"></p><ol><li><p>В <strong>Входящие подключения</strong> найдите ваш основной входящий <strong>dokodemo</strong> (часто с тегом <code>all-in</code>).<br> Нажмите кнопку <strong>транспорт</strong> рядом с ним.</p><p>Откроется модальное окно <strong>Способы передачи (uTLS, REALITY)</strong>.</p><p><img src="'+d+'" alt="транспорт"></p></li><li><p>Найдите строку <strong>Прозрачный прокси (tproxy)</strong> и нажмите <strong>настроить</strong>.<br><img src="'+a+'" alt="настроить"></p></li><li><p>В модальном окне <strong>Настройки прозрачного прокси</strong> установите <strong>Включить прозрачный прокси</strong> в значение <code>tproxy</code>.<br><img src="'+i+'" alt="тпрокси"></p></li><li><p>Нажмите <strong>сохранить</strong>. Убедитесь, что рядом с входящим dokodemo появился оранжевый бейдж <code>tproxy</code>.</p></li><li><p>Вернитесь на главную страницу и нажмите <strong>применить</strong>, чтобы отправить изменения на роутер и при необходимости перезапустить Xray.</p></li></ol>',23)]))}const h=o(c,[["render",l]]),T=JSON.parse('{"path":"/ru/tproxy.html","title":"Прозрачное проксирование (TPROXY)","lang":"ru-RU","frontmatter":{},"git":{"updatedTime":1755376010000,"contributors":[{"name":"Daniel Lavrushin","username":"","email":"lavrushin@gmail.com","commits":1}],"changelog":[{"hash":"11d81a64c796237091b4ea2611b463785fe498ef","time":1755376010000,"email":"lavrushin@gmail.com","author":"Daniel Lavrushin","message":"Add documentation for Transparent Proxy (TPROXY) in English and Russian"}]},"filePathRelative":"ru/tproxy.md"}');export{h as comp,T as data};
