# Включение Swap на ASUS роутерах с Merlin

## Что такое Swap и зачем он нужен

Роутеры имеют ограниченный объём оперативной памяти (RAM) — обычно от 256 MB до 1 GB. Когда запущенным приложениям не хватает памяти, система аварийно завершает их с ошибкой `out of memory`.

**Swap** — это файл на USB-накопителе, который система использует как дополнительную «медленную» память. Когда RAM заканчивается, редко используемые данные выгружаются в swap, освобождая место для активных процессов.

### Когда нужен Swap

- Xray, sing-box или другие прокси падают с ошибкой `fatal error: runtime: out of memory`
- Роутер зависает или перезагружается под нагрузкой
- Вы используете несколько ресурсоёмких приложений одновременно (VPN + прокси + торренты)

:::caution

Swap медленнее оперативной памяти в десятки раз. Он не сделает роутер быстрее — он лишь предотвратит падения при пиковых нагрузках. Если приложения постоянно используют swap, производительность заметно снизится.
:::

## Включение Swap через amtm

1. Подключитесь к роутеру по SSH

1. Запустите amtm:

   ```bash
   amtm
   ```

1. Выберите пункт **sw** (Swap file) в меню

1. Выберите размер swap-файла:

   - Для большинства случаев достаточно **256 MB** или **512 MB**
   - Для Xray и других тяжёлых приложений рекомендуется **512 MB** и больше

1. Дождитесь создания swap-файла

1. Перезагрузите роутер

![swap](../.vuepress/public/images/swap/20251215211014.png)

## Проверка

После перезагрузки убедитесь, что swap активен:

```bash
free -m
```

В строке `Swap` должно отображаться ненулевое значение.

Альтернативная проверка:

```bash
cat /proc/swaps
```

## Удаление Swap

Если нужно отключить swap — снова запустите `amtm`, выберите **sw** и следуйте инструкциям для удаления.

## Примечания

- Swap создаётся на USB-накопителе в `/tmp/mnt/<имя_раздела>/.swap`
- Использование swap на флешке сокращает её срок службы при интенсивной записи
- Для постоянной работы ресурсоёмких приложений предпочтительнее роутер с большим объёмом RAM
